"0","#first, we grab the proportions of extinctions in each bin for the data that has no NAs, "
"0","#the count per species group over the total counts for data without na values"
"0","#note, the dataframe is already alphabetically sorted by group names"
"0","proportions <- master_noNA$count/536"
"0",""
"0","#next, we take those proportions multiply it by the total number of NAs for each bin year, this number is 157 as we have seen above "
"0","NAcount <- 157*proportions"
"0",""
"0","#now add those NA counts per bin + the count for data with no NAs together into the dataframe"
"0","all_types_NA <- master_noNA %>%"
"0","  select(extinct_year, count, group) %>%"
"0","  mutate(NA_derived_count = NAcount)"
"0",""
"0","#lets write a function to calculate cumulative sum for the uncertain counts per species group "
"0","count_cumsum_NA <- function(table) {"
"0","  table %>%"
"0","  plyr::mutate(cumsum_lowNA = cumsum(NA_derived_count)) "
"0","}"
"0",""
"0","birds_NA <- count_cumsum_NA(all_types_NA %>% filter(group == ""Birds""))"
"0","mammals_NA <- count_cumsum_NA(all_types_NA %>% filter(group == ""Mammals""))"
"0","vert_NA <- count_cumsum_NA(all_types_NA %>% filter(group == ""Vertebrates""))"
"0","other_NA <- count_cumsum_NA(all_types_NA %>% filter(group == ""Other Vertebrates""))"
"0",""
"0","#lets bind them back into the dataframe"
"0","bind_NAs <- rbind(birds_NA, mammals_NA, vert_NA, other_NA)"
"0","bind_NAs"
